# v1.2.x Changelog

## v1.2.2 - 2026-01-29

### Added

- **Segment-based statusline**: Configurable segments (Model, Git, Directory, Context, Session, Output Style, MCP)
  - Presets: minimal, standard, full
  - Config file: `~/.config/oh-my-claude/statusline.json`
  - Semantic colors: Green (good), Yellow (warning), Red (critical), Cyan (neutral)
- **Statusline CLI commands**: `preset` and `toggle` subcommands for runtime configuration
  - `oh-my-claude statusline preset <minimal|standard|full>` - Change preset
  - `oh-my-claude statusline toggle <segment> [on|off]` - Toggle individual segments
- **Rich context system**: Automatic context gathering for MCP background agents
  - Context types: project-structure, package-info, git-status, config-files, readme, recent-changes, test-patterns
  - Smart keyword-based detection, per-agent context profiles and token budgets
- **Concurrent background task execution**: Semaphore-based concurrency limiting
  - Global limit (10) and per-provider limits (DS: 5, ZP: 5, MM: 3)
  - StatusLine shows concurrency slots: `(2/10)`, `(5/5 +2q)`
- **Non-blocking MCP commands**: `/omc-oracle` and `/omc-librarian` use non-blocking pattern
  - `poll_task` wait_seconds parameter reduces polling noise
- **YAML frontmatter for agents**: Agent .md files include proper frontmatter with name, description, tools

### Changed

- **Default preset changed to "full"**: Installation now uses "full" preset showing all segments
- **"standard" preset updated**: Now includes Model, Git, Directory, Context, Session, MCP segments
- **Session segment shows quota only**: Removed cost display, shows only API quota usage
  - OAuth credential reading from Keychain (macOS) or `~/.claude/.credentials.json`
  - Display format: `79% 7d:4%` (5-hour %, 7-day %)
- **Context segment**: Shows token usage from transcript parsing
- **Enhanced statusline**: Shows provider/model abbreviations and truncated prompt preview
- **Removed unused concurrency system** (dead code cleanup)

### Fixed

- **Windows compatibility**: Fixed "Open with" popup dialogs for Node.js scripts
  - MCP server, hooks, and statusline now use full path to `node.exe` on Windows
- **Windows git segment timeout**: Increased timeout from 50ms to 500ms for reliable operation
- **Cross-platform stderr suppression**: Replaced `2>/dev/null` with `stdio: ["pipe", "pipe", "ignore"]`
- **Agent parse errors**: Fixed missing "name" field in YAML frontmatter for all agent files
- **Invalid agent reference**: Fixed in statusline formatter
- **Regular install**: Now updates existing command files; force install preserves statusline wrapper

---

## v1.2.1 - 2026-01-17

### Fixed

- Doctor command distinguishes Task tool vs MCP agents
- Model names use dot format (`claude-sonnet-4.5`)
- Version detection in `oh-my-claude doctor --detail`
- Beta channel detection with `.beta-channel` marker file

---

## v1.2.0 - 2026-01-17

### Breaking Changes

- **Removed fallback system**: MCP agents now require their respective API keys

### Added

- **`analyst` agent**: DeepSeek Chat for quick code analysis
- **`execute_agent` MCP tool**: Blocking variant of `launch_background_task`

### Improved

- StatusLine per-session tracking
- Process tree walking for accurate session identification
