# /omc-pref

Manage user preferences — persistent "always do X" / "never do Y" rules that auto-inject into relevant sessions.

## Instructions

The user wants to manage their preferences. Parse the **subcommand** from arguments to determine the action.

## Subcommands

### `add` — Create a new preference

**Syntax:** `/omc-pref add "<title>" [--tags tag1,tag2] [--scope global|project] [--no-auto-inject]`

**Parse arguments:**
- `title` (required): The preference rule in quotes (e.g., "Never use co-author in git commits")
- `--tags`: Comma-separated tags for categorization (default: auto-generated from title)
- `--scope`: Storage scope, "global" or "project" (default: global)
- `--no-auto-inject`: If present, set autoInject to false (default: true)

**Step 1: Auto-generate triggers from title**

Extract keywords from the title to use as trigger keywords. Remove common stop words (never, always, use, do, the, a, in, for, with, when, don't). The remaining significant words become trigger keywords.

Example: "Never use co-author in git commits" → keywords: ["co-author", "git", "commits"]

**Step 2: Create the preference**

```
Use mcp__oh-my-claude-background__add_preference with:
- title: <parsed title>
- content: <same as title, or expanded if user provides more detail>
- scope: <parsed scope, default "global">
- autoInject: <true unless --no-auto-inject>
- trigger: { keywords: <auto-generated keywords> }
- tags: <parsed tags, or auto-generated from title keywords>
```

**Step 3: Confirm creation**

Display:
```
Preference Created
==================
ID:          pref-20260216-never-use-co-author-in-git-commits
Title:       Never use co-author in git commits
Scope:       global
Auto-inject: true
Triggers:    ["co-author", "git", "commits"]
Tags:        [git, commit]
```

---

### `list` — List all preferences

**Syntax:** `/omc-pref list [--scope global|project|all] [--tags tag1,tag2]`

**Parse arguments:**
- `--scope`: Filter by scope (default: all)
- `--tags`: Filter by tags

```
Use mcp__oh-my-claude-background__list_preferences with:
- scope: <parsed scope, default omit for all>
- tags: <parsed tags if provided>
```

**Display as table:**
```
Preferences (5 total)
=====================
ID                                          | Title                              | Scope   | Auto | Tags
--------------------------------------------|------------------------------------|---------|----- |------
pref-20260216-never-use-co-author           | Never use co-author in commits     | global  | yes  | git, commit
pref-20260215-always-use-bun                | Always use bun, not npm            | project | yes  | tooling
pref-20260214-prefer-functional             | Prefer functional components       | global  | no   | react, style
```

Sort by created date (newest first).

---

### `show` — Show full preference details

**Syntax:** `/omc-pref show <id>`

**Parse arguments:**
- `id` (required): Preference ID (supports prefix matching)

```
Use mcp__oh-my-claude-background__get_preference with:
- id: <parsed id>
```

**Display full details:**
```
Preference Details
==================
ID:          pref-20260216-never-use-co-author-in-git-commits
Title:       Never use co-author in git commits
Content:     When creating git commits, never add Co-authored-by trailers.
Scope:       global
Auto-inject: true

Triggers:
  Keywords:   ["co-author", "git", "commits"]
  Categories: (none)
  Always:     no

Tags:        [git, commit]
Created:     2026-02-16T10:30:00Z
Updated:     2026-02-16T10:30:00Z
```

---

### `remove` — Delete a preference

**Syntax:** `/omc-pref remove <id>`

**Parse arguments:**
- `id` (required): Preference ID (supports prefix matching)

**Step 1: Fetch the preference first**

```
Use mcp__oh-my-claude-background__get_preference with:
- id: <parsed id>
```

**Step 2: Ask for confirmation**

Show the preference title and ask: "Delete preference '...'? (yes/no)"

**Step 3: If confirmed, delete**

```
Use mcp__oh-my-claude-background__delete_preference with:
- id: <full preference id>
```

Display: "Preference deleted: <id>"

---

### `disable` — Disable auto-injection

**Syntax:** `/omc-pref disable <id>`

**Parse arguments:**
- `id` (required): Preference ID (supports prefix matching)

```
Use mcp__oh-my-claude-background__update_preference with:
- id: <parsed id>
- autoInject: false
```

Display: "Disabled auto-inject for: <title>"

---

### `enable` — Enable auto-injection

**Syntax:** `/omc-pref enable <id>`

**Parse arguments:**
- `id` (required): Preference ID (supports prefix matching)

```
Use mcp__oh-my-claude-background__update_preference with:
- id: <parsed id>
- autoInject: true
```

Display: "Enabled auto-inject for: <title>"

---

### `edit` — Modify a preference

**Syntax:** `/omc-pref edit <id> [--title "new title"] [--content "new content"] [--tags tag1,tag2] [--add-keyword kw] [--remove-keyword kw]`

**Parse arguments:**
- `id` (required): Preference ID (supports prefix matching)
- `--title`: New title
- `--content`: New content
- `--tags`: Replace tags
- `--add-keyword`: Add a trigger keyword
- `--remove-keyword`: Remove a trigger keyword

**Step 1: Fetch current preference**

```
Use mcp__oh-my-claude-background__get_preference with:
- id: <parsed id>
```

**Step 2: If no flags provided, show current values and ask what to change**

Present the current preference and ask the user what they'd like to modify. This enables interactive editing.

**Step 3: Apply updates**

```
Use mcp__oh-my-claude-background__update_preference with:
- id: <parsed id>
- <only include changed fields>
```

Display the updated preference details.

---

### `suggest` — AI-powered preference suggestions

**Syntax:** `/omc-pref suggest`

Scans recent session context to identify patterns that could become preferences.

**Step 1: Analyze recent session**

Look at the current conversation for:
- Repeated corrections by the user (e.g., "I said don't use X")
- Explicit style preferences (e.g., "always prefer Y")
- Tool usage patterns (e.g., user always asks for bun instead of npm)
- Code style preferences expressed in reviews

**Step 2: Generate suggestions**

For each identified pattern, propose a preference:

```
Suggested Preferences
=====================

1. "Always use bun instead of npm"
   Reason: You corrected npm usage 3 times in this session
   Tags: [tooling, package-manager]

2. "Prefer const over let for declarations"
   Reason: You mentioned this preference when reviewing code
   Tags: [code-style, javascript]

Would you like to add any of these? (1,2,all,none)
```

**Step 3: Create selected preferences**

For each selected suggestion, create the preference using the `add` workflow above.

## Default Behavior

If no subcommand is provided (`/omc-pref` with no arguments), show the list (same as `/omc-pref list`).

## Error Handling

**If preference ID not found:**
Display: "Preference not found: <id>. Use `/omc-pref list` to see all preferences."

**If MCP server not available:**
Display error and suggest running `oh-my-claude doctor`.

**If duplicate preference detected:**
Warn the user about the similar existing preference and ask if they still want to create it.

## Examples

```
User: /omc-pref add "Never use co-author in git commits" --tags git,commit
→ Creates preference with auto-generated triggers

User: /omc-pref list --scope project
→ Lists project-scoped preferences only

User: /omc-pref show pref-20260216
→ Shows full details (prefix match)

User: /omc-pref disable pref-20260216-never-use-co-author
→ Disables auto-injection for this preference

User: /omc-pref enable pref-20260216-never-use-co-author
→ Re-enables auto-injection

User: /omc-pref edit pref-20260216 --title "No co-author trailers"
→ Updates the title

User: /omc-pref remove pref-20260216
→ Deletes after confirmation

User: /omc-pref suggest
→ AI analyzes session for potential preferences

User: /omc-pref
→ Lists all preferences (default action)
```

ARGUMENTS: $ARGUMENTS
